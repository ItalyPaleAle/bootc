baseImages:
  alma-linux-9:
    image: quay.io/almalinuxorg/almalinux-bootc
    tag: "9"
    digest: sha256:e725ac7057917692509356cf3e98955ecaf77caba683237b8146af05975acebb
  base:
    localImage: base
  centos-stream-9:
    image: quay.io/centos-bootc/centos-bootc
    tag: stream9
    digest: sha256:5fc8a03e604e0721361f993a812fbaf03e211937919c638ab63e930de078ec24
  tailscale:
    localImage: tailscale
  zfs:
    localImage: zfs
apps:
  alloy:
    version: 1.5.1
    cmds:
      updateVersion: |
        curl -Ls "https://api.github.com/repos/grafana/alloy/releases/latest" \
          | jq '.tag_name' -r \
          | cut -c 2-
  gotop:
    version: 4.2.0
    checksums: 9c3f2f072b82918c56a15a229b528ba7d1e01d54cc809f64555852fa775ef8a6 gotop_v4.2.0_linux_amd64.rpm
    cmds:
      updateVersion: |
        curl -Ls "https://api.github.com/repos/xxxserxxx/gotop/releases/latest" \
          | jq '.tag_name' -r \
          | cut -c 2-
      updateChecksums: |
        VERSION=$(curl -Ls "https://api.github.com/repos/xxxserxxx/gotop/releases/latest" \
          | jq '.tag_name' -r)
        SHA=$(curl -sL "https://github.com/xxxserxxx/gotop/releases/download/${VERSION}/gotop_${VERSION}_linux_amd64.rpm" | sha256sum | cut -d " " -f 1)
        echo "${SHA} gotop_${VERSION}_linux_amd64.rpm"
  k3s:
    version: 1.31.3+k3s1
    checksums: |-
      0d4aee46981d6aa78ed9285f8d97be175d6bf07ed3cac952e7f861b4a3ecddf7  k3s
      2ca79ab27d731e3610bcce84c90f819a627bd631b79a393e6566f4ada22969a1  k3s-arm64
    cmds:
      updateVersion: |
        curl -sL "https://api.github.com/repos/k3s-io/k3s/releases/latest" \
          | jq '.tag_name' -r \
          | cut -c 2-
      updateChecksums: |
        VERSION=$(curl -sL "https://api.github.com/repos/k3s-io/k3s/releases/latest" | jq -r '.tag_name')
        # Print checksum for "k3s" (for amd64)
        curl -sL "https://github.com/k3s-io/k3s/releases/download/${VERSION}/sha256sum-amd64.txt" | grep "k3s$"
        # Print checksum for "k3s-arm64"
        curl -sL "https://github.com/k3s-io/k3s/releases/download/${VERSION}/sha256sum-arm64.txt" | grep "k3s-arm64$"
  restic:
    version: 0.17.3
    checksums: |-
      5097faeda6aa13167aae6e36efdba636637f8741fed89bbf015678334632d4d3  restic_0.17.3_linux_amd64.bz2
      db27b803534d301cef30577468cf61cb2e242165b8cd6d8cd6efd7001be2e557  restic_0.17.3_linux_arm64.bz2
    cmds:
      updateVersion: |
        curl -Ls "https://api.github.com/repos/restic/restic/releases/latest" \
          | jq '.tag_name' -r \
          | cut -c 2-
      updateChecksums: |
        URL=$(curl -sL https://api.github.com/repos/restic/restic/releases/latest \
          | jq -r '.assets[] | select(.name == "SHA256SUMS") | .browser_download_url')
        curl -sL $URL \
          | grep "linux_arm64\|linux_amd64"
  tailscale:
    version: 1.78.1
    cmds:
      updateVersion: |
        curl -Ls "https://api.github.com/repos/tailscale/tailscale/releases/latest" \
          | jq '.tag_name' -r \
          | cut -c 2-
  zfs:
    version: 2.2.7
    checksums: b2b8e3bfabf2a6407a0132243726cb6762547a5bd095b1b1f37eaf2a9d8f7672  zfs-2.2.7.tar.gz
    cmds:
      updateVersion: |
        curl -Ls "https://api.github.com/repos/openzfs/zfs/releases/latest" \
          | jq '.tag_name' -r \
          | cut -c 5-
      updateChecksums: |
        VERSION=$(curl -Ls "https://api.github.com/repos/openzfs/zfs/releases/latest" \
          | jq '.tag_name' -r)
        curl -sL "https://github.com/openzfs/zfs/releases/download/${VERSION}/${VERSION}.sha256.asc" \
          | grep ${VERSION}.tar.gz
